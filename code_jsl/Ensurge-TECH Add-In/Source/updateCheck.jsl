/***************** UPDATE THIS FILE AT YOUR OWN RISK *****************/If( !Namespace Exists( "com.ensurge.tech" ), New Namespace( "com.ensurge.tech" ) );com.ensurge.tech:checkForUpdate = Function( {force=0}, 	{Default Local}, 	Try(				// The include will return an Associative Array		customMetadata_aa = Include( "customMetadata.jsl" );				// Only do this check for the PROD add-ins		If( customMetadata_aa["state"] == "PROD",					// assign variables for the installed add-in's name, build date			addinName = customMetadata_aa["name"];			buildDate = customMetadata_aa["buildDate"];						// Import the add-in publish info from the shared server location			pub_aa = Eval( Parse( Load Text File( customMetadata_aa["deployedAddinsLoc"] || customMetadata_aa["deployedAddinsFilename"] ) ) );						// If, for some reason, this add-in's ID was not in the table, there's no way to know if a new version is available			If( pub_aa << Contains( customMetadata_aa["id"] ),								thisPub_aa = pub_aa[customMetadata_aa["id"]];								// get the publish date and filepath for the add-in				pubDate = thisPub_aa["pubDate"];				filepath = thisPub_aa["folder"] || thisPub_aa["filename"];								// if the publish date is newer than the build date of the current add-in, then there is a new version				If( buildDate < pubDate, 										// if we're not forcing an update, let's prompt the user if they want to get the new version					If( force == 0,						answer = 0;						New Window( "Update Available!",							<<modal,							V List Box(								Text Box(									"An updated version of " || addinName || " was published on " || Format( pubDate, "Short Date" ) || ".",									<<Set Font Style( "bold" )								),								Text Box(),								Text Box( "Click 'OK' to install the updated version, or 'Cancel' to continue using the present version." ),								Text Box(),								H List Box( Spacer Box(), Button Box( "OK", answer = 1 ), Button Box( "Cancel" ) )							)						),						answer = 1					);					// If they clicked 'OK' (or your forced them to update), open the newest add-in to install it					If( answer == 1,						Open( filepath );						New Window( "Re-Run", modal, Text Box( "An updated version of the " || addinName || " add-in has been installed. Please launch the add-in again." ) );						Stop();					);				);			);		);	););